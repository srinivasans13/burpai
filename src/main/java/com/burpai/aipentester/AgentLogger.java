package com.burpai.aipentester;

import java.io.FileWriter;
import java.io.PrintWriter;
import java.util.function.Consumer;

/**
 * Centralised logging helper used by all agent services.
 * Writes to the UI log callback and optionally to a persistent log file.
 */
class AgentLogger {

  private final Consumer<String> ui;
  private final String logFilePath;

  AgentLogger(Consumer<String> ui, String logFilePath) {
    this.ui = ui;
    this.logFilePath = logFilePath;
  }

  void log(String msg) {
    ui.accept(msg);
    if (logFilePath != null) {
      try (PrintWriter out = new PrintWriter(new FileWriter(logFilePath, true))) {
        out.print(msg);
        out.flush();
      } catch (Exception ignored) {
        // Ignore file logging failures to avoid cascading errors
      }
    }
  }

  String logFilePath() {
    return logFilePath;
  }
}
