package com.burpai.aipentester;

import burp.api.montoya.BurpExtension;
import burp.api.montoya.MontoyaApi;

public class Extension implements BurpExtension {

  @Override
  public void initialize(MontoyaApi api) {
    // Montoya lifecycle entrypoint. 
    api.logging().logToOutput("AI Pentest Agent starting up... Version: " + System.currentTimeMillis());
    api.extension().setName("AI Pentest Agent (Montoya + Ollama)");

    AgentTab tab = new AgentTab(api);

    // Register Suite tab. 
    api.userInterface().registerSuiteTab("AI Pentester", tab.ui());

    // Register context menu provider. 
    api.userInterface().registerContextMenuItemsProvider(tab);
  }
}
